# Scripting API
```ts
// 2 new methods.
class PlayerInventory {
    // Returns the Armor slot of an item, based on ID.
    function getArmorSlot(itemId: number): number;

    // Returns the Armor slot of an item, based on ID and damage value.
    function getArmorSlot(itemId: number, itemDamage: number): number;
}
```

```ts
// New class in preparation for multiplayer and per-player game modes, similar to modern MC.
class GameMode {
    function getName(): "debug" | "adventure";
}

// 1 new method.
class EntityPlayer {
    // Returns the currently active game mode.
    function getGameMode(): GameMode;
}
```

```ts
// Primitive types that persist on save.
// Boolean is not supported yet (not explicitly representable in NBT).
type Tag = null | number | string;

enum Facing {
	Down = 0,
	Up = 1,
	North = 2,
	South = 3,
	West = 4,
	East = 5,
}

// 1 new property, 4 new methods.
class Entity {
    // If entity has noclip active (no collision with blocks, triggers, ...)
    get noPhysics(): boolean;
    set noPhysics(value: boolean);
    
    // Get if a value with the given key exists.
    function hasTag(key: string): boolean;

    // Get a tag by key.
    function getTag(key: string): Tag;

    // Set a tag by key. 
    // Returns the previous value.
    // Unsupported types will not persist on save.
    function setTag(key: string, value: Tag): Tag;

    // Returns the face direction of the yaw rotation based on the cardinal points.
    function getFacing(): Facing;
}
```

```ts
enum ColorMode {
    Default = 0,
    AttachedTo = 1,
    Custom = 2,
    ModelAttachment = 3,
}

class Model {
    colorMode: ColorMode;

    color: Vec4;
    
    /** @deprecated renamed to colorMode */
    modes: ColorMode;

    /** @deprecated use color.r or .x */
    colorRed: number;
    
    /** @deprecated use color.g or .y */
    colorGreen: number;
    
    /** @deprecated use color.b or .z */
    colorBlue: number;
    
    /** @deprecated use color.a or .w */
    colorAlpha: number;
}
```

```ts
// New 4D vector type, similar to the existing Vec3.
class Vec4 {
    x: number;
    y: number;
    z: number;
    w: number;

	constructor(x: number, y: number, z: number, w: number);
    
	constructor(xyz: Vec3, w: number);

    // Component-wise add.
	function add(other: Vec4): Vec4;

    // Component-wise subtract.
    function subtract(other: Vec4): Vec4;

    // Component-wise multiply by scalar.
	function scale(value: number): Vec4;

    // Euclidean length.
	function length(): number;

    // Euclidean distance.
	function distance(other: Vec4): number;

    // Alias of XYZ.
    get xyz(): Vec3;
    set xyz(values: Vec3); 

    // Alias of x.
    get r(): number;
    set r(value: number);

    // Alias of y.
    get g(): number;
    set g(value: number);
    
    // Alias of z.
    get b(): number;
    set b(value: number);
    
    // Alias of w.
    get a(): number;
    set a(value: number);
}

class Vec3 {
    // New aliases for XYZ. 

    // Alias of x.
    get r(): number;
    set r(value: number);

    // Alias of y.
    get g(): number;
    set g(value: number);
    
    // Alias of z.
    get b(): number;
    set b(value: number);
}
```

# Quality of Life

- new command /gamerule with parameters...
    - as replacement for previous command:
        - /toggledecay (toggles leave decay) -> /gamerule decay_leaves [true/false]
        - /togglemelting (toggles ice melting) -> /gamerule melt_ice [true/false]
        - /mobsburn (toggles mobs burning in daylight) -> /gamerule sunburn_undead [true/false]
    - as replacement for /config button...
        - /gamerule allow_inventory_crafting (toggles, if player can craft in inventory)
    - as completely new rule:
        - /gamerule allow_bed (toggles if player can sleep in beds) (Issue #7)
        - /gamerule allow_hoe (toggles hoe usage outside of debug mode) (Issue#11)
        - /gamerule allow_bonemeal (toggles bonemeal usage outside of debug mode) (Issue#15)
        - /gamerule freeze_water (toggles if water freezes while it's snowing/temperature low)
        - /gamerule snow_accumulation_height (sets maximum snow accumulation height on ground while it's snowing)
- Your selected mainhand and offhand slots will still be selected after a reload (Issue#60)
- timer blocks got adjusted:
    - no more sliders, instantly input fields
    - input fields starting with correct decimal separator
    - input fields showing wrong input values in red color

- Middle mouse click on blocks in debug mode puts the hitBlock into your current slot
- Customizable spawner scripts are now selected with a file picker + search bar
- Debug View (F3) now also shows commit version + reorganized FPS label, etc.
- Renderer was completely rewritten, which should boost the overall performance
- new Chatbox in debug mode (allows marking with Shift + arrow keys and pasting inside the currently existing text
  instead of replacing the whole text as previously)
- Blockbench Support got extended (enables using inflate on single boxes)
- Copy & Paste Tool now also copies the NBT data (trigger settings, effect block settings, flower sizes, ...)
- Nudge Tool now also copies the NBT data (trigger settings, effect block settings, flower sizes, ...)
- improved arrow entity performance (less drawcalls)
- Updated /scriptstats screen
    - keeps running now during visibility
    - you can order the different key numbers now

# Bugfixes

- Cake, Repeater and Sugar cane can't be placed outside of debug mode
  anymore [#9](https://github.com/Adventurecraft-Awakening/AC-Legacy-Mod/issues/9)
- Cake can be consumed as long as player health < player
  maxHealth [#10](https://github.com/Adventurecraft-Awakening/AC-Legacy-Mod/issues/10)
    - previously you could only eat cake, if health < 20 (5 hearts)
- You can now place blocks at height y = 127 [#43](https://github.com/Adventurecraft-Awakening/AC-Legacy-Mod/issues/43)
- destroy speed while flying is now the same as while being on
  ground [#23](https://github.com/Adventurecraft-Awakening/AC-Legacy-Mod/issues/23)
- Double-click a save works again
- heartpieces won't get removed when pressing ESC anymore
- Boomerang flies through clip blocks per default again (was accidentally reversed with last big update)
- JS errors in custom mob OnAttacked scripts don't crash the game
  anymore [#114](https://github.com/Adventurecraft-Awakening/AC-Legacy-Mod/issues/114)
- UILabels/UISprites/UIRects won't be visible anymore in other save when you exit a save through the
  death screen exit button [#105](https://github.com/Adventurecraft-Awakening/AC-Legacy-Mod/issues/105)
- setOnCreated function now works as it should. Directly assigning and executing the OnCreated script once
    - this is part of an overall entity scope fix
- Advanced OpenGL fixed + improved culling
- keyboard triggers now only work in intended modes (e.g. not during F7 item palette, not in ESC menu)
- Shift + E now only opens the item palette in debug mode (as it was initially intended)

